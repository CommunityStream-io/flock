<section class="auth-section">
  <div class="auth-container">
    <h2 class="step-title">Authenticate with Bluesky</h2>
    <p class="step-description">Authenticate with Bluesky to migrate</p>

    <form [formGroup]="authForm" class="auth-form bluesky-auth">
      <div class="form-fields">
        <!-- Username Field -->
        <div class="username-field-container">
          <mat-form-field appearance="outline" class="username-field">
            <mat-label>Username</mat-label>
            <span matTextPrefix>@&nbsp;</span>
            <input
              matInput
              formControlName="username"
              name="username"
              placeholder="username.bksy.social"
              type="text"
              autocomplete="username"
              [class.error]="authForm.get('username')?.invalid && authForm.get('username')?.touched"
            >
            <mat-icon matSuffix>account_circle</mat-icon>
            @if (authForm.get('username')?.invalid && authForm.get('username')?.touched) {
              <mat-error class="username-error mat-error">
                {{ getUsernameErrorMessage() }}
              </mat-error>
            }
            <mat-hint>Must contain at least two dots (e.g., username.bksy.social)</mat-hint>
          </mat-form-field>
          
          <!-- Help Button -->
          <button
            mat-icon-button
            class="help-button"
            (click)="openHelpDialog()"
            [attr.aria-label]="'Show help information'"
          >
            <mat-icon>help_outline</mat-icon>
          </button>
        </div>

        <!-- Password Field -->
        <mat-form-field appearance="outline" class="password-field">
          <mat-label>Password</mat-label>
          <input
            matInput
            formControlName="password"
            name="password"
            placeholder="Enter your password"
            type="password"
            autocomplete="current-password"
            [class.error]="authForm.get('password')?.invalid && authForm.get('password')?.touched"
          >
          <mat-icon matSuffix>lock</mat-icon>
          @if (authForm.get('password')?.invalid && authForm.get('password')?.touched) {
            <mat-error class="password-error mat-error">
              {{ getPasswordErrorMessage() }}
            </mat-error>
          }
        </mat-form-field>
      </div>

      <!-- Authentication Status Display -->
      @if (authError()) {
        <div class="auth-error form-error error-message">
          <mat-icon class="error-icon">error</mat-icon>
          <span class="error-message">{{ authError() }}</span>
        </div>
      }
      
      @if (isAuthenticated() && !authError()) {
        <div class="auth-success success-message">
          <mat-icon class="success-icon">check_circle</mat-icon>
          <span class="success-message">Authentication successful! You can now proceed to the next step.</span>
        </div>
      }

      <!-- Form Actions - Navigation handled by step-navigation component -->
    </form>


  </div>
</section>
