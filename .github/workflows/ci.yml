name: Feathering the Nest

on:
  push:
    branches: [ "*" ]

jobs:
  node-setup:
    uses: ./.github/workflows/node-setup.yml
    with:
      node-version: '24.5.0'
      cache-dependency-path: package-lock.json

  build:
    name: Flock Project Build
    runs-on: ubuntu-latest
    needs: node-setup
    env:
      PACKAGE_TOKEN: ${{ secrets.PACKAGE_TOKEN }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          submodules: recursive
      - name: Build shared library
        run: npx ng build --project=shared
      - name: Build flock-mirage app
        run: npx ng build --project=flock-mirage --configuration=development
